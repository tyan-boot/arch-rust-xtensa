# Maintainer: Your Name <youremail@domain.com>

pkgname=rust-xtensa-git
pkgver=r137847.65ed48e
pkgrel=1
pkgdesc="Rust for ESP Xtensa"
arch=('x86_64')
url="https://github.com/MabezDev/rust-xtensa"
license=('GPL')
makedepends=('git' 'cmake' 'ninja' 'llvm-xtensa')
provides=('rust-xtensa')
source=(
  'git+https://github.com/MabezDev/rust-xtensa#commit=c4c02e8375fccb31e5d0e0e1bf283e40413fe59b'
)
sha256sums=('SKIP')

prepare() {
  cd ${srcdir}/rust-xtensa
}

build() {
  cd ${srcdir}/rust-xtensa
  ./configure --experimental-targets=Xtensa --llvm-root=/opt/llvm-xtensa --enable-optimize --enable-extended
  DESTDIR="$PWD"/dest-rust python x.py install
}

package() {
  cd ${srcdir}/rust-xtensa
  mkdir -p "$pkgdir"/opt/rust-xtensa

  cp -a dest-rust/* "$pkgdir"/opt/rust-xtensa
}
